 Управляющие коды цветного драйвера консоли (расширение VT52, опознаватель A2h)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      !!!       При старте драйвера есть возможность записать любую
                экранную область в TPA DOS по адресам TPA:4000..B7FF
                в формате команды драйвера 27,'W',3 в цветном режиме.
                Для записи удерживайте клавиши 0..3 при старте драйвера
                до появления надписи о подтверждении записи. !!!

ESC,'4' - включить автоперевод строки
ESC,'5' - выключить автоперевод строки
ESC,'@',byte - byte(1..1fh) - вывод символа с кодом < 20h
07 - BELL
08 и др. курсорные все как в РК-86
09 - горизонтальная табуляция через 8
0A - CLS+HOME
1F - CLS+HOME
1B,'6' - включить инверсный вывод, в цветном режиме при этом цвет фона и сим-
        волов меняются местами.
1B,'7' - выключить инверсный вывод (т.е включить нормальный режим)
1B,':' - включить курсор
1B,';' - выключить курсор
ESC,'N' - возвращает позицию курсора на экране с клавиатуры в виде
          ESC,Y,LN+20h,COL+20h
ESC,'Y',LN,COL - прямое позиционирование курсора
ESC,'E' - CLS (аналог 0C)
ESC,'H' - HOME (без очистки экрана)
ESC,'J' - стирание до конца экрана (включая позицию курсора)
ESC,'K' - стирание до конца строки (вкл-я позицию курсора)
ESC,'L' - вставить строку
ESC,'M' - удалить строку

ESC,'C',MODE - выбор режима работы работы драйвера, реализованы 6 режимов:
        MODE 0 - монохром, палитра 1 (зел./черн.)
        MODE 1 - 4-х цветный режим, палитра 1
        MODE 2 - 16-ти цветный режим (обычный)
        MODE 3 - 16-ти цветный скоростной (т.е без вывода цвета, в расчете,
        что вывод "идет" тем же цветом, что был в этом знакоместе ранее)
        MODE 4 - монохром, палитра 2 (син./желт.)
        MODE 5 - 4-х цветный, палитра 2
   !!!  Если в байте MODE бит D7 установить в 1, то при включении видеорежима
        не будет происходить очистка цветовых атрибутов. !!!

ESC,'Q',BYTE - установить ширину символа (6,8)
ESC,'P',BYTE - установить цвет в цветном режиме:
               в старшем ниббле BYTE передается код цвета фона, в младшем код
               цвета символов.
               В 4-х цветном режиме поддерживаются цвета 0, 1, 2, 4
               коды цветов выбраны так, чтобы обеспечить совместимость с 16-ти
               цветным режимом:
               0 - черный, 1 - голубой, 2 - зеленый, 4 - красный.
               Полная таблица цветов ОРИОНа:
                  Код цвета                 Цвет
                     0        черный              black
                     1        голубой             blue
                     2        зеленый             green
                     3        синий               cyan
                     4        красный             red
                     5        малиновый           magenta
                     6        коричневый          brown
                     7        белый               white
                     8        серый               gray
                     9        светло-голубой      lightblue
                    10        светло-зеленый      lightgreen
                    11        светло-синий        lightcyan
                    12        светло-красный      lightred
                    13        светло-малиновый    lightmagenta
                    14        желтый              yellow
                    15        интенсивно-белый    brightwhite
ESC,'R',BYTE - переключение формы курсора (BYTE= 1-8, толщина курсора)

        Оконные функции (в последующих версиях возможны дополнения).

ESC,'W',0,Y,X,dY,dX - определить окно вывода. X,Y - абсолютные координаты
                      левого верхнего угла окна в символьных позициях.
                      dX,dY - размер окна по X и по Y соответственно. Коорди-
                      ната X и размер по X должны быть кратны 4 в режиме 6x10.
                      Чтобы установить окно размером во весь экран нужно вывес-
                      ти: ESC,'W',0,0,0,25,80.
ESC,'W',1 - получить параметры текущего окна. Возвращает Y,X,dY,dX.
ESC,'W',2 - получить размер окна в байтах. Возвращает мл.байт,ст.байт.
ESC,'W',3,младш,старш,номер_стр. - сохранить содержимое окна по переданному
                                  адресу.
ESC,'W',4,младш,старш,номер_стр. - восстановить содержимое окна.

        Дополнительные управляющие коды драйвера.
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ESC,'D',n - установка задержки ввода с клавиатуры, n = 0..9
esc,'D',0FFh - получить текущую константу задержки

(h,m,s - часы,минуты,секунды в двоичном формате)
(d,m,y - день,месяц,год в двоичном формате)
ESC,'Z' - работа с часами:
 esc,'Z',0 - получение значения часов с клавиатуры в h,m,s
 esc,'Z',1,h,m,s - установка часов в формате h,m,s.
 esc,'Z',2 - получить состояние часов
 esc,'Z',3,byte - установить состояние часов
  состояние часов:
   d0 - 1/0 - разрешен/запрещен вывод времени
   d1 - 1/0 - вывод времени с инверсией/без инверсии
   d2 - 1/0 - полный/сокращенный формат вывода времени
   d3 - 1/0 - 24/12 часовой режим (не реализовано.)
 esc,'Z',4 - получение позиции для вывода времени (2 байта)
 esc,'Z',5,Y,X - установка позиции для вывода времени
(Y,X - 0..24,0..70; начало координат - левый верхний угол)
 esc,'Z',6 - пол. дату в формате d,m,y
 esc,'Z',7,d,m,y - уст. дату в формате d,m,y

ESC,'S',n - управление звуком
 (при нажатии РУС/ЛАТ звук включается).
        n = 0 выключить подзвучку при нажатии клавиш.
        n = 1 включить подзвучку при нажатии клавиш.
        n = 0FFh получить код управления звуком (0-1)

              {  не руководствоваться !
ESC,'F',n - управление фонтами:
(adr,bnk - адрес и банк, где расположен фонт пользователя.)
        n = 0 - включить стандартный фонт 6 бит.
        n = 1 - включить стандартный фонт 8 бит.
 esc,'F',2,adr,bnk - включить фонт пользователя 6 бит.
 esc,'F',3,adr,bnk - включить фонт пользователя 8 бит.
 esc,'F',4 - получить адрес 6-бит фонта с клавиатуры в фор-
             мате adr,bnk.
 esc,'F',5 - получить адрес 8-бит фонта с клавиатуры в фор-
             мате adr,bnk (если системный фонт,то XX:FF:XX).
               }
ESC,'X',n - управление режимом вывода символов на экран.
 n = 0 - установить нормальный режим вывода фонта 6.
 n = 1 - установить нормальный режим вывода фонта 8.
 n = 2 - установить режим наложения символов для фонта 6.
 n = 3 - установить режим наложения символов для фонта 8.
При выводе символов с параметром n = 2 или 3 необходимо
выключать курсор.

ESC,'B' - заполнение атрибутов цвета кодом, ранее установ-
          ленным через код 27,'P',byte

ESC,'I' - установить/получить номер АКТИВНОГО экрана
          (0..2/FF). Все операции драйвера выполняются
          только на АКТИВНОМ экране. На стандартном Орионе
          доступны 3 экрана (0..2) (hex:0,4000h,8000h).

ESC,'V' - установить/получить номер ВИДИМОГО экрана
          (0..2/FF). Одновременно устанавливается цветовой
          режим, ранее установленный на этом экране, если
          он уже был или является текущим АКТИВНЫМ экраном.
          Если экран не включался как АКТИВНЫЙ, то устано-
          вится монохром.

Бит D5 ячейки F3F6 установлен в 1 при вводе ESC - последовательности или при
выводе результатов через клавиатуру. Указывает на невозможность прерывания про-
граммы в данный момент времени.
 ESC,'U',0/1 - получить/восстановить состояние драйвера консоли
Состояние драйвера консоли: 13 байт
byte0:D0,D1 - код цветового режима      (00b-mono/01b-16cfast/10b-4c/11b-16c
              активного экрана
      D2 - инверсия                     (0-нет/1-есть)
      D3 - погашен/видимый курсор       (0-нет/1-есть)
      D4 - шрифт 6/8 бит                (0-6_бит/1-8_бит)
      D5 - наложение для 6 бит          (0-нет/1-есть)
      D6 - наложение для 8 бит          (0-нет/1-есть)
      D7 - auto_CRLF                    (0-нет/1-есть)
byte1,byte2: позиция курсора            (Y+20h/X+20h)
byte3 - форма курсора                   (1..8)
byte4 - код цвета                       (byte)
byte5 - y
byte6 - x  - параметры
byte7 - dy
byte8 - dx
byte9  - номер АКТИВНОГО экрана (D0..D1) (00b..10b)
       - номер ВИДИМОГО экрана  (D2..D3) (00b..10b)
byte10 - видеокод экрана 0  (видеокод - это byte из ESC,'C',byte)
byte11 - видеокод экрана 1
byte12 - видеокод экрана 2
                        ВНИМАНИЕ:

1. ПРИ ИСПОЛЬЗОВАНИИ ЭКРАНОВ 1 И 2 ВО ИЗБЕЖАНИЕ КОНФЛИКТОВ
С ДОС И ДРАЙВЕРАМИ, А ТАК ЖЕ С ДРУГИМИ ПРОГРАММАМИ, ИСПОЛЬ-
ЗУЮЩИМИ XTPA, ПЕРЕД ИСПОЛЬЗОВАНИЕМ ЭКРАННОЙ ПАМЯТИ  ОБЯЗА-
ТЕЛЬНО ЗАРЕЗЕРВИРУЙТЕ ЭТУ ПАМЯТЬ (Ф.103 BDOS) НА ВРЕМЯ РА-
БОТЫ С ЭТИМИ ЭКРАНАМИ, А ПОСЛЕ ЗАВЕРШЕНИЯ РАБОТЫ ОСВОБОДИ-
ТЕ ЭКРАННУЮ ПАМЯТЬ (Ф-ЦИЯ 104 BDOS). ЕСЛИ Ф-ЦИЯ 103 BDOS
ВОЗВРАТИЛА ВАМ ФЛАГ ОШИБКИ, ТО ЭТУ ЭКРАННУЮ ПАМЯТЬ ИСПОЛЬ-
ЗОВАТЬ В ДАННЫЙ МОМЕНТ НЕЛЬЗЯ.

2. ЭКРАН 0 - ЭТО СИСТЕМНЫЙ ЭКРАН, В КАРТЕ ПАМЯТИ ЕГО ОЗУ
ВСЕГДА ОБОЗНАЧЕНО КАК ЗАНЯТОЕ. НЕ РЕЗЕРВИРУЙТЕ И НЕ ОСВО-
БОЖДАЙТЕ ЭТО ЭКРАННОЕ ОЗУ!

3. РАСПРЕДЕЛЕНИЕ ОЗУ:

ЭКРАН 0  -> B0:0000-3FFF, B1:0000-3FFF
СЕГМЕНТЫ 00..03(ГРАФ.), 10H..13H(ЦВЕТ)

ЭКРАН 1  -> B0:4000-7FFF, B1:4000-7FFF
СЕГМЕНТЫ 04..07(ГРАФ.), 14H..17H(ЦВЕТ)

ЭКРАН 2  -> B0:8000-BFFF, B1:8000-BFFF
СЕГМЕНТЫ 08..0BH(ГРАФ.), 18H..1BH(ЦВЕТ)

НА НЕКОТОРЫХ РЕЛИЗАХ СЕГМЕНТЫ 19H,1АH,1BH
МОГУТ БЫТЬ ЗАНЯТЫ И ИСПОЛЬЗОВАТЬ ОБЛАСТЬ ЦВЕТА
ДЛЯ ЭКРАНА 2 В ЭТОМ СЛУЧАЕ НЕЛЬЗЯ (ТОЛЬКО
МОНОХРОМ)

